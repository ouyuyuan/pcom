
! Description: common routines for programming
!
!      Author: OU Yuyuan <ouyuyuan@lasg.iap.ac.cn>
!     Created: 2015-09-14 17:36:48 BJT
! Last Change: 2015-10-03 07:40:48 BJT

module mod_pro

  implicit none
  private

  public &
    pro_allo_chk, &
    pro_days_month, &
    pro_days_year
    
contains !{{{1

subroutine pro_allo_chk( ista ) !{{{1
  integer, intent(in) ::  ista

  if ( ista /= 0 ) then
    stop 'Allocate array failed.'
  end if
end subroutine pro_allo_chk


function pro_days_month (y, m) !{{{1
  ! calc. days of a specific month of a specific year
  integer, intent(in) :: y, m
  integer :: pro_days_month

  integer :: days(12)

  days(:) = (/31, 28, 31, 30, &
              31, 30, 31, 31, &
              30, 31, 30, 31/)

  pro_days_month = days(m)

  if ( m == 2 ) then
    if ( pro_days_year (y) == 366 ) pro_days_month = 29
  end if

end function pro_days_month


function pro_days_year (y) !{{{1
  ! calc. days of a specific year
  integer, intent(in) :: y
  integer :: pro_days_year

  if (y <= 0) stop 'year should be positive in function pro_days_year'
  
  pro_days_year = 365

  if ( mod(y, 100) == 0 ) then
    if ( mod(y, 400) == 0 ) pro_days_year = 366
  else
    if ( mod(y, 4)   == 0 ) pro_days_year = 366
  end if

end function pro_days_year

end module mod_pro !{{{1
!-------------------------------------------------------{{{1
! vim:fdm=marker:fdl=0:
! vim:foldtext=getline(v\:foldstart).'...'.(v\:foldend-v\:foldstart):
